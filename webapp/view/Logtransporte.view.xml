<mvc:View controllerName="ventilado.ventiladoptl.controller.Logtransporte"
    xmlns="sap.ui.table"
    xmlns:rowmodes="sap.ui.table.rowmodes"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:m="sap.m" height="100%">

    <m:Page title="Log de transporte" enableScrolling="false">
        <m:content>

            <!-- Filtros -->
            <m:VBox class="sapUiSmallMargin">
                <m:HBox wrap="Wrap" renderType="Bare">

                    <!-- Desde -->
                    <m:VBox class="sapUiTinyMarginEnd">
                        <m:Label text="Desde:" labelFor="dpFrom"/>
                        <m:DatePicker id="dpFrom" valueFormat="yyyy-MM-dd" displayFormat="dd/MM/yyyy" placeholder="por ejemplo 31/12/2025"/>
                    </m:VBox>

                    <!-- Hasta -->
                    <m:VBox class="sapUiTinyMarginEnd">
                        <m:Label text="Hasta:" labelFor="dpTo"/>
                        <m:DatePicker id="dpTo" valueFormat="yyyy-MM-dd" displayFormat="dd/MM/yyyy" placeholder="por ejemplo 31/12/2025"/>
                    </m:VBox>

                    <!-- Transporte -->
                    <m:VBox class="sapUiTinyMarginEnd">
                        <m:Label text="Transporte:" labelFor="inpTransporte"/>
                        <m:Input id="inpTransporte" width="180px"/>
                    </m:VBox>

                    <!-- Tipo: PTL / Tradicional / Ambos -->
                    <m:VBox class="sapUiTinyMarginEnd">
                        <m:Label text="Tipo:" labelFor="rbTipo"/>
                        <m:RadioButtonGroup id="rbTipo" columns="3" select=".onTipoChange">
                            <m:buttons>
                                <m:RadioButton text="PTL" selected="true"/>
                                <m:RadioButton text="Tradicional"/>
                                <m:RadioButton text="Ambos"/>
                            </m:buttons>
                        </m:RadioButtonGroup>
                    </m:VBox>

                    <!-- Botón Buscar -->
                    <m:VBox class="sapUiTinyMarginBegin">
                        <m:Label text=" "/>
                        <m:Button text="Buscar" press=".onSearch"/>
                    </m:VBox>

                </m:HBox>
            </m:VBox>

            <m:HBox class="sapUiSmallMarginBottom">
                    <m:Button text="Descargar Excel" icon="sap-icon://excel-attachment" press=".onDownloadExcel"/>
            </m:HBox>

            <!-- Tabla desktop con scrollbar vertical propio -->
            <Table id="kpiTableDesktop" rows="{/tableData}" selectionMode="None" enableColumnReordering="true"  fixedColumnCount ="4" >

                <!-- Altura/scroll automático -->
                <rowMode>
                    <rowmodes:Fixed rowCount="15"/>
                </rowMode>

                <!-- Columnas -->
                <columns>
                    <Column label="Fecha" width="5rem" resizable="true">
                        <template>
                            <m:Text wrapping="false" text="{path: 'Fechainicio',
             type: 'sap.ui.model.odata.type.DateTime',
             constraints: { displayFormat: 'Date', UTC: true },
             formatOptions: { pattern: 'dd-MM-yy', UTC: true }}"/>
                        </template>
                    </Column>

                    <Column label="Op" width="6.5rem" resizable="true" hAlign="Center">
                        <template>
                            <m:Text wrapping="false" maxLines="1" text="{Operador}"/>
                        </template>
                    </Column>

                    <Column label="Estación" width="5rem" resizable="true">
                        <template>
                            <m:Text wrapping="false" maxLines="1" text="{Estacion}"/>
                        </template>
                    </Column>

                    <Column label="Reparto" width="6rem" resizable="true">
                        <template>
                            <m:Link text="{Transporte}" press=".onTransporteLinkPress"/>
                        </template>
                    </Column>

                    <Column label="Kg Br"  width="6rem">
                        <template>
                            <m:Text text="{Kiloentrega}"/>
                        </template>
                    </Column>

                    <Column label="Volumen (m³)" width="7rem">
                        <template>
                            <m:Text text="{Volumenentrega}" wrapping="false"/>
                        </template>
                    </Column>

                    <Column label="Cant Unid." width="7rem">
                        <template>
                            <m:Text text="{Cantidaditem}" wrapping="false"/>
                        </template>
                    </Column>

                    <Column label="Cant EANS" width="7rem">
                        <template>
                            <m:Text text="{Cantidadean}" wrapping="false"/>
                        </template>
                    </Column>

                    <Column label="Cant Clientes" width="7rem">
                        <template>
                            <m:Text text="{Cantidadentrega}" wrapping="false"/>
                        </template>
                    </Column>

                    <Column label="Cant Cubetas" width="7rem">
                        <template>
                            <m:Text text="{Cantidadcubeta}" wrapping="false"/>
                        </template>
                    </Column>

                    <Column label="Cant Roll" width="7rem">
                        <template>
                            <m:Text text="{Cantidadroll}" wrapping="false"/>
                        </template>
                    </Column>

                    <Column label="Cant Pallets" width="7rem">
                        <template>
                            <m:Text text="{Cantidadpallet}" wrapping="false"/>
                        </template>
                    </Column>

                    <Column label="T. Prep." width="5rem">
                        <template>
                            <m:Text text="{Duracionpreparacion}" wrapping="false"/>
                        </template>
                    </Column>

                    <Column label="T. Scan" width="5rem">
                        <template>
                            <m:Text text="{Duracionneta}" wrapping="false"/>
                        </template>
                    </Column>

                    <Column label="T. Final" width="5rem">
                        <template>
                            <m:Text text="{Duracionfinal}" wrapping="false"/>
                        </template>
                    </Column>

                    <Column label="T. Product." width="5rem">
                        <template>
                            <m:Text text="{Tiempoproductivo}" wrapping="false"/>
                        </template>
                    </Column>

                    <Column label="T. Pausa" width="5rem">
                        <template>
                            <m:Text text="{Tiempopausa}" wrapping="false"/>
                        </template>
                    </Column>

                    <Column label="T. Total Bruto" width="7rem">
                        <template>
                            <m:Text text="{Tiempobruto}" wrapping="false"/>
                        </template>
                    </Column>
                </columns>
            </Table>

        </m:content>
    </m:Page>
</mvc:View>
